module.exports=p,p.Minimatch=f;var t={sep:"/"};try{t=require("path")}catch(t){}var e=p.GLOBSTAR=f.GLOBSTAR={},r=require("brace-expansion"),n={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},i="[^/]",s=i+"*?",a="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",o="(?:(?!(?:\\/|^)\\.).)*?",h=function(t){return t.split("").reduce(function(t,e){return t[e]=!0,t},{})}("().*{}+?[]^$\\!");var c=/\/+/;function u(t,e){t=t||{},e=e||{};var r={};return Object.keys(e).forEach(function(t){r[t]=e[t]}),Object.keys(t).forEach(function(e){r[e]=t[e]}),r}function p(t,e,r){if("string"!=typeof e)throw new TypeError("glob pattern string required");return r||(r={}),!(!r.nocomment&&"#"===e.charAt(0))&&(""===e.trim()?""===t:new f(e,r).match(t))}function f(e,r){if(!(this instanceof f))return new f(e,r);if("string"!=typeof e)throw new TypeError("glob pattern string required");r||(r={}),e=e.trim(),"/"!==t.sep&&(e=e.split(t.sep).join("/")),this.options=r,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function g(t,e){if(e||(e=this instanceof f?this.options:{}),void 0===(t=void 0===t?this.pattern:t))throw new TypeError("undefined pattern");return e.nobrace||!t.match(/\{.*\}/)?[t]:r(t)}p.filter=function(t,e){return e=e||{},function(r,n,i){return p(r,t,e)}},p.defaults=function(t){if(!t||!Object.keys(t).length)return p;var e=p,r=function(r,n,i){return e.minimatch(r,n,u(t,i))};return r.Minimatch=function(r,n){return new e.Minimatch(r,u(t,n))},r},f.defaults=function(t){return t&&Object.keys(t).length?p.defaults(t).Minimatch:f},f.prototype.debug=function(){},f.prototype.make=function(){if(this._made)return;var t=this.pattern,e=this.options;if(!e.nocomment&&"#"===t.charAt(0))return this.comment=!0,void 0;if(!t)return this.empty=!0,void 0;this.parseNegate();var r=this.globSet=this.braceExpand();e.debug&&(this.debug=console.error);this.debug(this.pattern,r),r=this.globParts=r.map(function(t){return t.split(c)}),this.debug(this.pattern,r),r=r.map(function(t,e,r){return t.map(this.parse,this)},this),this.debug(this.pattern,r),r=r.filter(function(t){return-1===t.indexOf(!1)}),this.debug(this.pattern,r),this.set=r},f.prototype.parseNegate=function(){var t=this.pattern,e=!1,r=0;if(this.options.nonegate)return;for(var n=0,i=t.length;n<i&&"!"===t.charAt(n);n++)e=!e,r++;r&&(this.pattern=t.substr(r));this.negate=e},p.braceExpand=function(t,e){return g(t,e)},f.prototype.braceExpand=g,f.prototype.parse=function(t,r){if(t.length>65536)throw new TypeError("pattern is too long");var a=this.options;if(!a.noglobstar&&"**"===t)return e;if(""===t)return"";var o,c="",u=!!a.nocase,p=!1,f=[],g=[],d=!1,b=-1,m=-1,v="."===t.charAt(0)?"":a.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",y=this;function w(){if(o){switch(o){case"*":c+=s,u=!0;break;case"?":c+=i,u=!0;break;default:c+="\\"+o}y.debug("clearStateChar %j %j",o,c),o=!1}}for(var x,E=0,j=t.length;E<j&&(x=t.charAt(E));E++)if(this.debug("%s\t%s %s %j",t,E,c,x),p&&h[x])c+="\\"+x,p=!1;else switch(x){case"/":return!1;case"\\":w(),p=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",t,E,c,x),d){this.debug("  in class"),"!"===x&&E===m+1&&(x="^"),c+=x;continue}y.debug("call clearStateChar %j",o),w(),o=x,a.noext&&w();continue;case"(":if(d){c+="(";continue}if(!o){c+="\\(";continue}f.push({type:o,start:E-1,reStart:c.length,open:n[o].open,close:n[o].close}),c+="!"===o?"(?:(?!(?:":"(?:",this.debug("plType %j %j",o,c),o=!1;continue;case")":if(d||!f.length){c+="\\)";continue}w(),u=!0;var O=f.pop();c+=O.close,"!"===O.type&&g.push(O),O.reEnd=c.length;continue;case"|":if(d||!f.length||p){c+="\\|",p=!1;continue}w(),c+="|";continue;case"[":if(w(),d){c+="\\"+x;continue}d=!0,m=E,b=c.length,c+=x;continue;case"]":if(E===m+1||!d){c+="\\"+x,p=!1;continue}if(d){var k=t.substring(m+1,E);try{RegExp("["+k+"]")}catch(t){var A=this.parse(k,l);c=c.substr(0,b)+"\\["+A[0]+"\\]",u=u||A[1],d=!1;continue}}u=!0,d=!1,c+=x;continue;default:w(),p?p=!1:!h[x]||"^"===x&&d||(c+="\\"),c+=x}d&&(k=t.substr(m+1),A=this.parse(k,l),c=c.substr(0,b)+"\\["+A[0],u=u||A[1]);for(O=f.pop();O;O=f.pop()){var S=c.slice(O.reStart+O.open.length);this.debug("setting tail",c,O),S=S.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(t,e,r){return r||(r="\\"),e+e+r+"|"}),this.debug("tail=%j\n   %s",S,S,O,c);var $="*"===O.type?s:"?"===O.type?i:"\\"+O.type;u=!0,c=c.slice(0,O.reStart)+$+"\\("+S}w(),p&&(c+="\\\\");var R=!1;switch(c.charAt(0)){case".":case"[":case"(":R=!0}for(var T=g.length-1;T>-1;T--){var C=g[T],L=c.slice(0,C.reStart),q=c.slice(C.reStart,C.reEnd-8),B=c.slice(C.reEnd-8,C.reEnd),M=c.slice(C.reEnd);B+=M;var N=L.split("(").length-1,_=M;for(E=0;E<N;E++)_=_.replace(/\)[+*?]?/,"");var G="";""===(M=_)&&r!==l&&(G="$");var P=L+q+M+G+B;c=P}""!==c&&u&&(c="(?=.)"+c);R&&(c=v+c);if(r===l)return[c,u];if(!u)return function(t){return t.replace(/\\(.)/g,"$1")}(t);var z=a.nocase?"i":"";try{var D=new RegExp("^"+c+"$",z)}catch(t){return new RegExp("$.")}return D._glob=t,D._src=c,D};var l={};p.makeRe=function(t,e){return new f(t,e||{}).makeRe()},f.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var r=this.options,n=r.noglobstar?s:r.dot?a:o,i=r.nocase?"i":"",h=t.map(function(t){return t.map(function(t){return t===e?n:"string"==typeof t?function(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(t):t._src}).join("\\/")}).join("|");h="^(?:"+h+")$",this.negate&&(h="^(?!"+h+").*$");try{this.regexp=new RegExp(h,i)}catch(t){this.regexp=!1}return this.regexp},p.match=function(t,e,r){var n=new f(e,r=r||{});return t=t.filter(function(t){return n.match(t)}),n.options.nonull&&!t.length&&t.push(e),t},f.prototype.match=function(e,r){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&r)return!0;var n=this.options;"/"!==t.sep&&(e=e.split(t.sep).join("/"));e=e.split(c),this.debug(this.pattern,"split",e);var i,s,a=this.set;for(this.debug(this.pattern,"set",a),s=e.length-1;s>=0&&!(i=e[s]);s--);for(s=0;s<a.length;s++){var o=a[s],h=e;n.matchBase&&1===o.length&&(h=[i]);var u=this.matchOne(h,o,r);if(u)return!!n.flipNegate||!this.negate}return!n.flipNegate&&this.negate},f.prototype.matchOne=function(t,r,n){var i=this.options;this.debug("matchOne",{this:this,file:t,pattern:r}),this.debug("matchOne",t.length,r.length);for(var s=0,a=0,o=t.length,h=r.length;s<o&&a<h;s++,a++){this.debug("matchOne loop");var c,u=r[a],p=t[s];if(this.debug(r,u,p),!1===u)return!1;if(u===e){this.debug("GLOBSTAR",[r,u,p]);var f=s,g=a+1;if(g===h){for(this.debug("** at the end");s<o;s++)if("."===t[s]||".."===t[s]||!i.dot&&"."===t[s].charAt(0))return!1;return!0}for(;f<o;){var l=t[f];if(this.debug("\nglobstar while",t,f,r,g,l),this.matchOne(t.slice(f),r.slice(g),n))return this.debug("globstar found match!",f,o,l),!0;if("."===l||".."===l||!i.dot&&"."===l.charAt(0)){this.debug("dot detected!",t,f,r,g);break}this.debug("globstar swallow a segment, and continue"),f++}return!(!n||(this.debug("\n>>> no match, partial?",t,f,r,g),f!==o))}if("string"==typeof u?(c=i.nocase?p.toLowerCase()===u.toLowerCase():p===u,this.debug("string match",u,p,c)):(c=p.match(u),this.debug("pattern match",u,p,c)),!c)return!1}if(s===o&&a===h)return!0;if(s===o)return n;if(a===h)return s===o-1&&""===t[s];throw new Error("wtf?")};