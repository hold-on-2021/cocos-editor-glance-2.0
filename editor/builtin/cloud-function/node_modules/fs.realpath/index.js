module.exports=l,l.realpath=l,l.sync=u,l.realpathSync=u,l.monkeypatch=function(){t.realpath=l,t.realpathSync=u},l.unmonkeypatch=function(){t.realpath=e,t.realpathSync=r};var t=require("fs"),e=t.realpath,r=t.realpathSync,n=process.version,a=/^v[0-5]\./.test(n),c=require("./old.js");function o(t){return t&&"realpath"===t.syscall&&("ELOOP"===t.code||"ENOMEM"===t.code||"ENAMETOOLONG"===t.code)}function l(t,r,n){if(a)return e(t,r,n);"function"==typeof r&&(n=r,r=null),e(t,r,function(e,a){o(e)?c.realpath(t,r,n):n(e,a)})}function u(t,e){if(a)return r(t,e);try{return r(t,e)}catch(r){if(o(r))return c.realpathSync(t,e);throw r}}