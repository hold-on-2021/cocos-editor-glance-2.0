var r=require("assert"),t=require("util");function e(e){var n,i,s,c,u,f,p,l,h,w=["([^%]*)","%","(['\\-+ #0]*?)","([1-9]\\d*)?","(\\.([1-9]\\d*))?","[lhjztL]*?","([diouxXfFeEgGaAcCsSp%jr])"].join(""),d=new RegExp(w),g=Array.prototype.slice.call(arguments,1),y="",E=1;for(r.equal("string",typeof e);null!==(h=d.exec(e));)if(y+=h[1],e=e.substring(h[0].length),n=h[2]||"",i=h[3]||0,s=h[4]||"",u=!1,p=!1,f=" ","%"!=(c=h[6])){if(0===g.length)throw new Error("too few args to sprintf");if(l=g.shift(),E++,n.match(/[\' #]/))throw new Error("unsupported flags: "+n);if(s.length>0)throw new Error("non-zero precision not supported");switch(n.match(/-/)&&(u=!0),n.match(/0/)&&(f="0"),n.match(/\+/)&&(p=!0),c){case"s":if(void 0===l||null===l)throw new Error("argument "+E+": attempted to print undefined or null as a string");y+=o(f,i,u,l.toString());break;case"d":l=Math.floor(l);case"f":y+=(p=p&&l>0?"+":"")+o(f,i,u,l.toString());break;case"x":y+=o(f,i,u,l.toString(16));break;case"j":0===i&&(i=10),y+=t.inspect(l,!1,i);break;case"r":y+=a(l);break;default:throw new Error("unsupported conversion: "+c)}}else y+="%";return y+=e}function n(r){var t=Array.prototype.slice.call(arguments,1);return r.write(e.apply(this,t))}function o(r,t,e,n){for(var o=n;o.length<t;)e?o+=r:o=r+o;return o}function a(r){var t;if(!(r instanceof Error))throw new Error(e("invalid type for %%r: %j",r));if(t="EXCEPTION: "+r.constructor.name+": "+r.stack,r.cause&&"function"==typeof r.cause){var n=r.cause();n&&(t+="\nCaused by: "+a(n))}return t}exports.sprintf=e,exports.printf=function(){var r=Array.prototype.slice.call(arguments);r.unshift(process.stdout),n.apply(null,r)},exports.fprintf=n;