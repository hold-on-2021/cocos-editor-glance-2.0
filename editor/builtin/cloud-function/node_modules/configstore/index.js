"use strict";const e=require("path"),t=require("os"),s=require("graceful-fs"),r=require("make-dir"),i=require("xdg-basedir"),a=require("write-file-atomic"),n=require("dot-prop"),l=require("unique-string"),o=i.config||e.join(t.tmpdir(),l()),h="You don't have access to this file.",c={mode:448},u={mode:384};module.exports=class{constructor(t,s,r){const i=(r=r||{}).globalConfigPath?e.join(t,"config.json"):e.join("configstore",`${t}.json`);this.path=e.join(o,i),this.all=Object.assign({},s,this.all)}get all(){try{return JSON.parse(s.readFileSync(this.path,"utf8"))}catch(t){if("ENOENT"===t.code)return r.sync(e.dirname(this.path),c),{};if("EACCES"===t.code&&(t.message=`${t.message}\n${h}\n`),"SyntaxError"===t.name)return a.sync(this.path,"",u),{};throw t}}set all(t){try{r.sync(e.dirname(this.path),c),a.sync(this.path,JSON.stringify(t,null,"\t"),u)}catch(e){throw"EACCES"===e.code&&(e.message=`${e.message}\n${h}\n`),e}}get size(){return Object.keys(this.all||{}).length}get(e){return n.get(this.all,e)}set(e,t){const s=this.all;if(1===arguments.length)for(const t of Object.keys(e))n.set(s,t,e[t]);else n.set(s,e,t);this.all=s}has(e){return n.has(this.all,e)}delete(e){const t=this.all;n.delete(t,e),this.all=t}clear(){this.all={}}};