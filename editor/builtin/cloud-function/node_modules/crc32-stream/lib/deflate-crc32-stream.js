"use strict";const{DeflateRaw:e}=require("zlib"),{crc32:s}=require("crc");module.exports=class extends e{constructor(e){super(e),this.checksum=Buffer.allocUnsafe(4),this.checksum.writeInt32BE(0,0),this.rawSize=0,this.compressedSize=0}push(e,s){return e&&(this.compressedSize+=e.length),super.push(e,s)}write(e,t,r){return e&&(this.checksum=s(e,this.checksum),this.rawSize+=e.length),super.write(e,t,r)}digest(e){const s=Buffer.allocUnsafe(4);return s.writeUInt32BE(this.checksum>>>0,0),e?s.toString(e):s}hex(){return this.digest("hex").toUpperCase()}size(e=!1){return e?this.compressedSize:this.rawSize}};