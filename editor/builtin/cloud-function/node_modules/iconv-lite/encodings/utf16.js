"use strict";var t=require("safer-buffer").Buffer;function e(){}function i(){}function o(){this.overflowByte=-1}function n(t,e){this.iconv=e}function r(t,e){void 0===(t=t||{}).addBOM&&(t.addBOM=!0),this.encoder=e.iconv.getEncoder("utf-16le",t)}function s(t,e){this.decoder=null,this.initialBytes=[],this.initialBytesLen=0,this.options=t||{},this.iconv=e.iconv}function c(t,e){var i=e||"utf-16le";if(t.length>=2)if(254==t[0]&&255==t[1])i="utf-16be";else if(255==t[0]&&254==t[1])i="utf-16le";else{for(var o=0,n=0,r=Math.min(t.length-t.length%2,64),s=0;s<r;s+=2)0===t[s]&&0!==t[s+1]&&n++,0!==t[s]&&0===t[s+1]&&o++;n>o?i="utf-16be":n<o&&(i="utf-16le")}return i}exports.utf16be=e,e.prototype.encoder=i,e.prototype.decoder=o,e.prototype.bomAware=!0,i.prototype.write=function(e){for(var i=t.from(e,"ucs2"),o=0;o<i.length;o+=2){var n=i[o];i[o]=i[o+1],i[o+1]=n}return i},i.prototype.end=function(){},o.prototype.write=function(e){if(0==e.length)return"";var i=t.alloc(e.length+1),o=0,n=0;for(-1!==this.overflowByte&&(i[0]=e[0],i[1]=this.overflowByte,o=1,n=2);o<e.length-1;o+=2,n+=2)i[n]=e[o+1],i[n+1]=e[o];return this.overflowByte=o==e.length-1?e[e.length-1]:-1,i.slice(0,n).toString("ucs2")},o.prototype.end=function(){},exports.utf16=n,n.prototype.encoder=r,n.prototype.decoder=s,r.prototype.write=function(t){return this.encoder.write(t)},r.prototype.end=function(){return this.encoder.end()},s.prototype.write=function(e){if(!this.decoder){if(this.initialBytes.push(e),this.initialBytesLen+=e.length,this.initialBytesLen<16)return"";var i=c(e=t.concat(this.initialBytes),this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(i,this.options),this.initialBytes.length=this.initialBytesLen=0}return this.decoder.write(e)},s.prototype.end=function(){if(!this.decoder){var e=t.concat(this.initialBytes),i=c(e,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(i,this.options);var o=this.decoder.write(e),n=this.decoder.end();return n?o+n:o}return this.decoder.end()};