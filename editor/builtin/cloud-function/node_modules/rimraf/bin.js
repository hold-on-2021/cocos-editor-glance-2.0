#!/usr/bin/env node
const e=require("./"),o=require("path"),r=e=>{const r=!1===n||!(e=>/^(\/|[a-zA-Z]:\\)$/.test(o.resolve(e)))(e);return r||(console.error(`refusing to remove ${e}`),console.error("Set --no-preserve-root to allow this")),r};let t=!1,s=!1,l=!1,n=!0;const i=process.argv.slice(2).filter(e=>{if(s)return!!e;if("--"===e)s=!0;else if("--no-glob"===e||"-G"===e)l=!0;else if("--glob"===e||"-g"===e)l=!1;else if(e.match(/^(-+|\/)(h(elp)?|\?)$/))t=!0;else if("--preserve-root"===e)n=!0;else{if("--no-preserve-root"!==e)return!!e;n=!1}}).filter(e=>!n||r(e)),a=o=>{if(o>=i.length)return;const r=l?{glob:!1}:{};e(i[o],r,e=>{if(e)throw e;a(o+1)})};if(t||0===i.length){const e=t?console.log:console.error;e("Usage: rimraf <path> [<path> ...]"),e(""),e('  Deletes all files and folders at "path" recursively.'),e(""),e("Options:"),e(""),e("  -h, --help          Display this usage info"),e("  -G, --no-glob       Do not expand glob patterns in arguments"),e("  -g, --glob          Expand glob patterns in arguments (default)"),e("  --preserve-root     Do not remove '/' (default)"),e("  --no-preserve-root  Do not treat '/' specially"),e("  --                  Stop parsing flags"),process.exit(t?0:1)}else a(0);