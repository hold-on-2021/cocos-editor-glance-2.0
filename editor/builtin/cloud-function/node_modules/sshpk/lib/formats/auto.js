module.exports={read:function(f,s){if("string"==typeof f){if(f.trim().match(/^[-]+[ ]*BEGIN/))return t.read(f,s);if(f.match(/^\s*ssh-[a-z]/))return i.read(f,s);if(f.match(/^\s*ecdsa-/))return i.read(f,s);if(f.match(/^putty-user-key-file-2:/i))return u.read(f,s);if(o(f))return a.read(f,s);f=e.from(f,"binary")}else{if(r.buffer(f),function(r){var e=0;for(;e<r.length&&(32===r[e]||10===r[e]);)++e;if(45!==r[e])return!1;for(;e<r.length&&45===r[e];)++e;for(;e<r.length&&32===r[e];)++e;return!(e+5>r.length||"BEGIN"!==r.slice(e,e+5).toString("ascii"))}(f))return t.read(f,s);if(function(r){var e=0;for(;e<r.length&&(32===r[e]||10===r[e]||9===r[e]);)++e;return e+4<=r.length&&"ssh-"===r.slice(e,e+4).toString("ascii")||e+6<=r.length&&"ecdsa-"===r.slice(e,e+6).toString("ascii")}(f))return i.read(f,s);if(function(r){var e=0;for(;e<r.length&&(32===r[e]||10===r[e]||9===r[e]);)++e;return e+22<=r.length&&"putty-user-key-file-2:"===r.slice(e,e+22).toString("ascii").toLowerCase()}(f))return u.read(f,s);if(o(f))return a.read(f,s)}if(f.readUInt32BE(0)<f.length)return n.read(f,s);throw new Error("Failed to auto-detect format of key")},write:function(r,e){throw new Error('"auto" format cannot be used for writing')}};var r=require("assert-plus"),e=require("safer-buffer").Buffer,t=(require("../utils"),require("../key"),require("../private-key"),require("./pem")),i=require("./ssh"),n=require("./rfc4253"),a=require("./dnssec"),u=require("./putty"),f="Private-key-format: v1";function o(r){if(r.length<=f.length)return!1;if(r.slice(0,f.length).toString("ascii")===f)return!0;"string"!=typeof r&&(r=r.toString("ascii"));for(var e=r.split("\n"),t=0;e[t].match(/^\;/);)t++;return!!e[t].toString("ascii").match(/\. IN KEY /)||!!e[t].toString("ascii").match(/\. IN DNSKEY /)}