var e=require("./x509");module.exports={read:function(t,a){"string"!=typeof t&&(r.buffer(t,"buf"),t=t.toString("ascii"));var n,u,l=t.trim().split(/[\r\n]+/g),s=-1;for(;!n&&s<l.length;)n=l[++s].match(/[-]+[ ]*BEGIN CERTIFICATE[ ]*[-]+/);r.ok(n,"invalid PEM header");var f=l.length;for(;!u&&f>0;)u=l[--f].match(/[-]+[ ]*END CERTIFICATE[ ]*[-]+/);r.ok(u,"invalid PEM footer"),l=l.slice(s,f+1);var o={};for(;l=l.slice(1),n=l[0].match(/^([A-Za-z0-9-]+): (.+)$/);)o[n[1].toLowerCase()]=n[2];return l=l.slice(0,-1).join(""),t=i.from(l,"base64"),e.read(t,a)},verify:e.verify,sign:e.sign,write:function(r,t){var a=e.write(r,t).toString("base64"),n=a.length+a.length/64+18+16+2*"CERTIFICATE".length+10,u=i.alloc(n),l=0;l+=u.write("-----BEGIN CERTIFICATE-----\n",l);for(var s=0;s<a.length;){var f=s+64;f>a.length&&(f=a.length),l+=u.write(a.slice(s,f),l),u[l++]=10,s=f}return l+=u.write("-----END CERTIFICATE-----\n",l),u.slice(0,l)}};var r=require("assert-plus"),i=(require("asn1"),require("safer-buffer").Buffer);require("../algs"),require("../utils"),require("../key"),require("../private-key"),require("./pem"),require("../identity"),require("../signature"),require("../certificate");