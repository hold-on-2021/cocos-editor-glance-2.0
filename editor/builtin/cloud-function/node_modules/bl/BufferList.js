"use strict";const t=Symbol.for("BufferList");function e(t){if(!(this instanceof e))return new e(t);e._init.call(this,t)}e._init=function(e){Object.defineProperty(this,t,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)},e.prototype._new=function(t){return new e(t)},e.prototype._offset=function(t){if(0===t)return[0,0];let e=0;for(let n=0;n<this._bufs.length;n++){const f=e+this._bufs[n].length;if(t<f||n===this._bufs.length-1)return[n,t-e];e=f}},e.prototype._reverseOffset=function(t){const e=t[0];let n=t[1];for(let t=0;t<e;t++)n+=this._bufs[t].length;return n},e.prototype.get=function(t){if(t>this.length||t<0)return;const e=this._offset(t);return this._bufs[e[0]][e[1]]},e.prototype.slice=function(t,e){return"number"==typeof t&&t<0&&(t+=this.length),"number"==typeof e&&e<0&&(e+=this.length),this.copy(null,0,t,e)},e.prototype.copy=function(t,e,n,f){if(("number"!=typeof n||n<0)&&(n=0),("number"!=typeof f||f>this.length)&&(f=this.length),n>=this.length)return t||Buffer.alloc(0);if(f<=0)return t||Buffer.alloc(0);const r=!!t,s=this._offset(n),i=f-n;let u=i,h=r&&e||0,o=s[1];if(0===n&&f===this.length){if(!r)return 1===this._bufs.length?this._bufs[0]:Buffer.concat(this._bufs,this.length);for(let e=0;e<this._bufs.length;e++)this._bufs[e].copy(t,h),h+=this._bufs[e].length;return t}if(u<=this._bufs[s[0]].length-o)return r?this._bufs[s[0]].copy(t,e,o,o+u):this._bufs[s[0]].slice(o,o+u);r||(t=Buffer.allocUnsafe(i));for(let e=s[0];e<this._bufs.length;e++){const n=this._bufs[e].length-o;if(!(u>n)){this._bufs[e].copy(t,h,o,o+u);break}this._bufs[e].copy(t,h,o),h+=n,u-=n,o&&(o=0)}return t},e.prototype.shallowSlice=function(t,e){if(t=t||0,e="number"!=typeof e?this.length:e,t<0&&(t+=this.length),e<0&&(e+=this.length),t===e)return this._new();const n=this._offset(t),f=this._offset(e),r=this._bufs.slice(n[0],f[0]+1);return 0===f[1]?r.pop():r[r.length-1]=r[r.length-1].slice(0,f[1]),0!==n[1]&&(r[0]=r[0].slice(n[1])),this._new(r)},e.prototype.toString=function(t,e,n){return this.slice(e,n).toString(t)},e.prototype.consume=function(t){for(;this._bufs.length;){if(!(t>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(t),this.length-=t;break}t-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},e.prototype.duplicate=function(){const t=this._new();for(let e=0;e<this._bufs.length;e++)t.append(this._bufs[e]);return t},e.prototype.append=function(t){if(null==t)return this;if(t.buffer)this._appendBuffer(Buffer.from(t.buffer,t.byteOffset,t.byteLength));else if(Array.isArray(t))for(let e=0;e<t.length;e++)this.append(t[e]);else if(this._isBufferList(t))for(let e=0;e<t._bufs.length;e++)this.append(t._bufs[e]);else"number"==typeof t&&(t=t.toString()),this._appendBuffer(Buffer.from(t));return this},e.prototype._appendBuffer=function(t){this._bufs.push(t),this.length+=t.length},e.prototype.indexOf=function(t,e,n){if(void 0===n&&"string"==typeof e&&(n=e,e=void 0),"function"==typeof t||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if("number"==typeof t?t=Buffer.from([t]):"string"==typeof t?t=Buffer.from(t,n):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=Buffer.from(t.buffer,t.byteOffset,t.byteLength):Buffer.isBuffer(t)||(t=Buffer.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),0===t.length)return e>this.length?this.length:e;const f=this._offset(e);let r=f[0],s=f[1];for(;r<this._bufs.length;r++){const e=this._bufs[r];for(;s<e.length;){if(e.length-s>=t.length){const n=e.indexOf(t,s);if(-1!==n)return this._reverseOffset([r,n]);s=e.length-t.length+1}else{const e=this._reverseOffset([r,s]);if(this._match(e,t))return e;s++}}s=0}return-1},e.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let n=0;n<e.length;n++)if(this.get(t+n)!==e[n])return!1;return!0},function(){const t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(const n in t)(function(n){e.prototype[n]=null===t[n]?function(t,e){return this.slice(t,t+e)[n](0,e)}:function(e){return this.slice(e,e+t[n])[n](0)}})(n)}(),e.prototype._isBufferList=function(t){return t instanceof e||e.isBufferList(t)},e.isBufferList=function(e){return null!=e&&e[t]},module.exports=e;