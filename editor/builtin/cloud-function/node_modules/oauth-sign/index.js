var r=require("crypto");function e(e,n,t){return r.createHmac(t,e).update(n).digest("base64")}function n(r){return encodeURIComponent(r).replace(/!/g,"%21").replace(/\*/g,"%2A").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/'/g,"%27")}function t(r,e){return r>e?1:r<e?-1:0}function a(r,e,a){var o=function(r){var e,n,t=[];for(e in r)if(n=r[e],Array.isArray(n))for(var a=0;a<n.length;a++)t.push([e,n[a]]);else if("object"==typeof n)for(var o in n)t.push([e+"["+o+"]",n[o]]);else t.push([e,n]);return t}(a).map(function(r){return[n(r[0]),n(r[1]||"")]}).sort(function(r,e){return t(r[0],e[0])||t(r[1],e[1])}).map(function(r){return r.join("=")}).join("&");return[n(r?r.toUpperCase():"GET"),n(e),n(o)].join("&")}function o(r,t,o,u,i){var c=a(r,t,o);return e([u||"",i||""].map(n).join("&"),c,"sha1")}function u(r,t,o,u,i){var c=a(r,t,o);return e([u||"",i||""].map(n).join("&"),c,"sha256")}function i(e,n,t,o,u){var i=a(e,n,t);return function(e,n){return r.createSign("RSA-SHA1").update(n).sign(e,"base64")}(o||"",i)}function c(r,e){return[r||"",e||""].map(n).join("&")}exports.hmacsign=o,exports.hmacsign256=u,exports.rsasign=i,exports.plaintext=c,exports.sign=function(r,e,n,t,a,s){var p,f=1;switch(r){case"RSA-SHA1":p=i;break;case"HMAC-SHA1":p=o;break;case"HMAC-SHA256":p=u;break;case"PLAINTEXT":p=c,f=4;break;default:throw new Error("Signature method not supported: "+r)}return p.apply(null,[].slice.call(arguments,f))},exports.rfc3986=n,exports.generateBase=a;