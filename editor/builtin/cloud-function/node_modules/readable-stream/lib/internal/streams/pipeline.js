"use strict";var r;var n=require("../../../errors").codes,t=n.ERR_MISSING_ARGS,e=n.ERR_STREAM_DESTROYED;function o(r){if(r)throw r}function i(r){r()}function u(r,n){return r.pipe(n)}module.exports=function(){for(var n=arguments.length,f=new Array(n),a=0;a<n;a++)f[a]=arguments[a];var c,p=function(r){return r.length?"function"!=typeof r[r.length-1]?o:r.pop():o}(f);if(Array.isArray(f[0])&&(f=f[0]),f.length<2)throw new t("streams");var s=f.map(function(n,t){var o=t<f.length-1;return function(n,t,o,i){i=function(r){var n=!1;return function(){n||(n=!0,r.apply(void 0,arguments))}}(i);var u=!1;n.on("close",function(){u=!0}),void 0===r&&(r=require("./end-of-stream")),r(n,{readable:t,writable:o},function(r){if(r)return i(r);u=!0,i()});var f=!1;return function(r){if(!u&&!f)return f=!0,function(r){return r.setHeader&&"function"==typeof r.abort}(n)?n.abort():"function"==typeof n.destroy?n.destroy():(i(r||new e("pipe")),void 0)}}(n,o,t>0,function(r){c||(c=r),r&&s.forEach(i),o||(s.forEach(i),p(c))})});return f.reduce(u)};