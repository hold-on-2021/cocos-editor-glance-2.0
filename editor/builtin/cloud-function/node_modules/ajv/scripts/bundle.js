"use strict";var e=require("fs"),r=require("path"),n=require("browserify"),i=require("uglify-js"),s=process.argv[2],a=process.argv[3],o=process.argv[4],m=r.join(__dirname,"..");"."!=s&&(m=r.join(m,"node_modules",s));var t=require(r.join(m,"package.json")),l=r.join(__dirname,"..","dist");e.existsSync(l)||e.mkdirSync(l);var c={};a&&(c.standalone=a),n(c).require(r.join(m,t.main),{expose:t.name}).bundle(function(n,s){n&&(console.error("browserify error:",n),process.exit(1));var m=r.join(l,t.name),c={warnings:!0,compress:{},output:{preamble:"/* "+t.name+" "+t.version+": "+t.description+" */"}};if(o)for(var p=o.split(","),u=0,g=p.length;u<g;++u){var f=p[u].split("=");c.compress[f[0]]=f.length<1||"false"!=f[1]}a&&(c.sourceMap={filename:t.name+".min.js",url:t.name+".min.js.map"});var j=i.minify(s.toString(),c);if(e.writeFileSync(m+".min.js",j.code),j.map&&e.writeFileSync(m+".min.js.map",j.map),a&&e.writeFileSync(m+".bundle.js",s),j.warnings)for(var v=0,d=j.warnings.length;v<d;++v)console.warn("UglifyJS warning:",j.warnings[v])});