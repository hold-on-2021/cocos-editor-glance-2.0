var r=require("once"),e=require("end-of-stream"),n=require("fs"),t=function(){},o=/^v?\.0/.test(process.version),i=function(r){return"function"==typeof r},u=function(u,a,c,f){f=r(f);var s=!1;u.on("close",function(){s=!0}),e(u,{readable:a,writable:c},function(r){if(r)return f(r);s=!0,f()});var p=!1;return function(r){if(!s&&!p)return p=!0,function(r){return!!o&&!!n&&(r instanceof(n.ReadStream||t)||r instanceof(n.WriteStream||t))&&i(r.close)}(u)?u.close(t):function(r){return r.setHeader&&i(r.abort)}(u)?u.abort():i(u.destroy)?u.destroy():(f(r||new Error("stream was destroyed")),void 0)}},a=function(r){r()},c=function(r,e){return r.pipe(e)};module.exports=function(){var r,e=Array.prototype.slice.call(arguments),n=i(e[e.length-1]||t)&&e.pop()||t;if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new Error("pump requires two streams per minimum");var o=e.map(function(t,i){var c=i<e.length-1;return u(t,c,i>0,function(e){r||(r=e),e&&o.forEach(a),c||(o.forEach(a),n(r))})});return e.reduce(c)};