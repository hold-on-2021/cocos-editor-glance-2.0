var t=require("util"),e=require("stream"),n=require("./constants"),i=module.exports=function(t){var i=this;e.Stream.call(this);var r=(t=t||{}).initialSize||n.DEFAULT_INITIAL_SIZE,f=t.incrementAmount||n.DEFAULT_INCREMENT_AMOUNT,u=new Buffer(r),h=0;this.writable=!0,this.readable=!1,this.size=function(){return h},this.maxSize=function(){return u.length},this.getContents=function(t){if(!h)return!1;var e=new Buffer(Math.min(t||h,h));return u.copy(e,0,0,e.length),e.length<h&&u.copy(u,0,e.length),h-=e.length,e},this.getContentsAsString=function(t,e){if(!h)return!1;var n=u.toString(t||"utf8",0,Math.min(e||h,h)),i=Buffer.byteLength(n);return i<h&&u.copy(u,0,i),h-=i,n};var o=function(t){if(u.length-h<t){var e=Math.ceil((t-(u.length-h))/f),n=new Buffer(u.length+f*e);u.copy(n,0,0,h),u=n}};this.write=function(t,e,n){i.writable&&(Buffer.isBuffer(t)?(o(t.length),t.copy(u,h,0),h+=t.length):(t+="",o(Buffer.byteLength(t)),u.write(t,h,e||"utf8"),h+=Buffer.byteLength(t)),"function"==typeof n&&n())},this.end=function(){var t=Array.prototype.slice.apply(arguments);t.length&&i.write.apply(i,t),i.emit("finish"),i.destroy()},this.destroySoon=this.destroy=function(){i.writable=!1,i.emit("close")}};t.inherits(i,e.Stream);