function i(){this.pending=0,this.max=1/0,this.listeners=[],this.waiting=[],this.error=null}function n(i){i.pending+=1;var n=!1;return function(e){if(n)throw new Error("callback called twice");if(n=!0,i.error=i.error||e,i.pending-=1,i.waiting.length>0&&i.pending<i.max)t(i,i.waiting.shift());else if(0===i.pending){var o=i.listeners;i.listeners=[],o.forEach(r)}};function r(n){n(i.error)}}function t(i,t){t(n(i))}module.exports=i,i.prototype.go=function(i){this.pending<this.max?t(this,i):this.waiting.push(i)},i.prototype.wait=function(i){0===this.pending?i(this.error):this.listeners.push(i)},i.prototype.hold=function(){return n(this)};