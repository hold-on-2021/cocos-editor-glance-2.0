"use strict";const e=require("../tar"),r=require("../gzip"),t=require("../utils"),s=require("stream"),i=require("pump"),o=require("get-ready");class a extends s.Transform{constructor(s){super(s=s||{});const o=this._sourceType=t.sourceType(s.source),a=this._tarStream=new e.FileStream(s);delete(s=t.clone(s)).source;const u=new r.FileStream(s);u.on("data",e=>{this.push(e)}),u.on("end",()=>this.ready(!0)),i(a,u,e=>{e&&this.emit("error",e)}),"stream"!==o&&void 0!==o&&this.end()}_transform(e,r,t){this._tarStream.write(e,r,t)}_flush(e){"stream"!==this._sourceType&&void 0!==this._sourceType||this._tarStream.end(),this.ready(e)}}o.mixin(a.prototype),module.exports=a;