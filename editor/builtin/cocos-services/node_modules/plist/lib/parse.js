var e=require("xmldom").DOMParser;function d(e){return 3===e.nodeType||8===e.nodeType||4===e.nodeType}function n(e){return!e.childNodes||0===e.childNodes.length}exports.parse=function(o){var r=(new e).parseFromString(o);if("plist"!==r.documentElement.nodeName)throw new Error("malformed document. First element should be <plist>");var l=function e(o){var r,l,i,t,s,u;if(!o)return null;if("plist"===o.nodeName){for(t=[],r=0;r<o.childNodes.length;r++)d(o.childNodes[r])||t.push(e(o.childNodes[r]));return t}if("dict"===o.nodeName){for(l={},i=null,r=0;r<o.childNodes.length;r++)d(o.childNodes[r])||(null===i?i=e(o.childNodes[r]):(l[i]=e(o.childNodes[r]),i=null));return l}if("array"===o.nodeName){for(t=[],r=0;r<o.childNodes.length;r++)d(o.childNodes[r])||null!=(s=e(o.childNodes[r]))&&t.push(s);return t}if("#text"===o.nodeName);else{if("key"===o.nodeName)return n(o)?null:(s="",o.childNodes[0]&&(s=o.childNodes[0].nodeValue),s);if("string"===o.nodeName){if(s="",n(o))return null;for(u=0;u<o.childNodes.length;u++)s+=o.childNodes[u].nodeValue;return s}if("integer"===o.nodeName)return parseInt(o.childNodes[0].nodeValue,10);if("real"===o.nodeName){for(s="",u=0;u<o.childNodes.length;u++)3===o.childNodes[u].nodeType&&(s+=o.childNodes[u].nodeValue);return parseFloat(s)}if("data"===o.nodeName){for(s="",u=0;u<o.childNodes.length;u++)3===o.childNodes[u].nodeType&&(s+=o.childNodes[u].nodeValue.replace(/\s+/g,""));return new Buffer(s,"base64")}if("date"===o.nodeName)return new Date(o.childNodes[0].nodeValue);if("true"===o.nodeName)return!0;if("false"===o.nodeName)return!1}}(r.documentElement);1==l.length&&(l=l[0]);return l};