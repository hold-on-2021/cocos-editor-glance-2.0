"use strict";var e=require("../../utils/arrays"),r=require("../visitor");module.exports=function(n,u){var i=[];e.each(n.rules,function(s,t){(function(e){return"rule"===e.type&&"rule_ref"===e.expression.type})(s)&&(function(e,n,u){r.build({rule_ref:function(e){e.name===n&&(e.name=u)}})(e)}(n,s.name,s.expression.name),e.contains(u.allowedStartRules,s.name)||i.push(t))}),i.reverse(),e.each(i,function(e){n.rules.splice(e,1)})};