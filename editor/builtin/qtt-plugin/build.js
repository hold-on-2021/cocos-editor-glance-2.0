let e=require("./lib/cpk-util.js");module.exports={name:Editor.T("qtt-runtime.platform_name"),platform:"qtt-game",extends:"runtime",buttons:[Editor.Builder.DefaultButtons.Build],messages:{"build-start":function(e,t){(function(e){let t=require("fs-extra"),i=require("path").join(e.dest,"manifest.json");if(t.existsSync(i)){var r,o;try{r=t.readJsonSync(i)}catch(e){r=void 0}void 0!==r&&void 0!==r.versionCode&&void 0!==(o=void 0!==Editor.Profile.load.getSelfData?Editor.Profile.load("project://qtt-runtime.json").getSelfData():Editor.Profile.load("profile://project/qtt-runtime.json").data)&&""!==o.versionCode&&void 0!==o.versionCode&&o.versionCode===r.versionCode&&o.versionName===r.versionName&&Editor.log(Editor.T("qtt-runtime.build_same_game_version_error"))}})(t);let i=require("fs-extra");i.existsSync(t.dest)&&i.emptyDirSync(t.dest),e.reply()},"build-finished":async function(t,i){var r=await e.gatherInfo(i,t);!1!==r&&!1!==(r=await e.organizeResources(t))&&(await e.pack(),t.reply(),function(e){var t;t=void 0!==Editor.Profile.load.getSelfData?Editor.Profile.load("project://qtt-runtime.json").getSelfData():Editor.Profile.load("profile://project/qtt-runtime.json").data;var i=CocosEngine,r=parseInt("2.2.1".replace(/[^\d]/g,""));if(parseInt(i.slice(0,6).replace(/[^\d]/g,""))>=r==1){let i={resUrl:t.tinyPackageServer,orientation:t.deviceOrientation,projectName:t.name};Editor.Ipc.sendToMain("builder:notify-build-result",e,i)}}(i))}},settings:Editor.url("packages://qtt-runtime/build-ui.js")};