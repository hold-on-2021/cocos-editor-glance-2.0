"use strict";require("lodash");const t=require("fire-path");function s(t){var s=Editor.assetdb.assetInfoByUuid(t);if(!s)return cc.js._getClassId(cc.Texture2D,!1);var e=s.type,i=Editor.assets[e];return i?cc.js._getClassId(i,!1):(Editor.error("Can not get asset type of "+t),cc.js._getClassId(cc.RawAsset,!1))}module.exports=class{constructor(){this._buildAssets=null,this._packedAssets=null,this._subpackages=null,this._nativeMd5Map=null,this._md5Map=null}containsAsset(t,s){var e=t in this._buildAssets;return!e&&s&&Editor.error(`The bulid not contains an asset with the given uuid "${t}".`),e}getAssetUuids(){return Object.keys(this._buildAssets)}getDependencies(t){return this.containsAsset(t,!0)?Editor.Utils.getDependsRecursively(this._buildAssets,t,"dependUuids"):[]}getAssetType(t){return this.containsAsset(t,!0),s(t)}getNativeAssetPath(t){return this.getNativeAssetPaths(t)[0]||""}getNativeAssetPaths(e){if(!this.containsAsset(e,!0))return[];let i=this._buildAssets[e];if("object"!=typeof i)return[];let n=[];i.nativePaths?n=i.nativePaths:i.nativePath&&(n=[i.nativePath]);let a=s(e),r=this._nativeMd5Map&&this._nativeMd5Map[e];if(r)for(let s=0;s<n.length;++s){let e=n[s];if("cc.TTFFont"===a)n[s]=t.join(t.dirname(e)+`.${r}`,t.basename(e));else{let t=e.lastIndexOf(".");n[s]=e.substr(0,t)+`.${r}`+e.substr(t,e.length)}}return n}};