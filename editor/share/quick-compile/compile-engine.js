const e=require("path"),n=require("./index.js"),i=require("./plugins/babel"),o=require("./plugins/module"),r=require("./engine-utils/delete-engine-cache");let t=!0;if(!("undefined"==typeof Editor)){const e=Editor.Profile.load("global://features.json");t=void 0===(t=e.get("bundle-quick-compiler-engine"))||t}module.exports=(async s=>{if(!s.enginePath)throw new Error("Please specify the engine path");let a=new n;function l(n){return e.join(s.enginePath,n||"")}let u=[l("external/box2d/box2d.js"),l("extensions/dragonbones/lib/dragonBones.js"),l("extensions/spine/lib/spine.js")],d={root:l(),entries:[l("index.js")],out:l("bin/.cache/dev"),plugins:[i({exludesForSourceMap:u}),o({bundle:t,modularName:"engine",exludesForSourceMap:u,prefix:"engine-dev",onSourceMap(n,i){i.sources=[e.join("engine-dev",e.relative(l(),n.src))],i.sourceRoot="/"}}),r(l)],clear:!1,onlyRecordChanged:!0};return s.enableWatch?await a.watch(d):await a.build(d),a});